{
	"name": "vw_InPatientSurvey",
	"properties": {
		"folder": {
			"name": "Patient Experience"
		},
		"content": {
			"query": "ALTER VIEW dbo.vw_FactIn_Patient_Survey AS\nSELECT INP.[SURVEYID] AS SurveyId\n,INP.[ORGANIZATION] AS Organization\n,INP.[REGION_NAME] AS Region\n,INP.[FACILITY_NAME] AS Facility\n,INP.[STATE_NM] AS [State]\n,INP.[CLIENTID] AS [ClientId]\n,INP.[AGE] AS Age\n,INP.[SEX] AS Gender\n,INP.[ITADMDAT] AS AdmDate\n,INP.[ITDISDAT] AS DiscDate\n--,DATEDIFF(DAY,CAST([ITADMDAT] AS DATE),CAST([ITDISDAT] AS DATE)) AS LengthOfStay\n,INP.[ITCITY] AS City\n,INP.[LANGUAGE] AS [Language]\n,INP.[CMS_1]\n,INP.[CMS_2]\n,INP.[CMS_3]\n,INP.[CMS_6]\n,INP.[CMS_7]\n,INP.[CMS_8]\n,INP.[CMS_37]\n,INP.[CMS_37CL]\n,INP.[CMS_13]\n,INP.[CMS_13CL]\n,INP.[CMS_21]\n,INP.[CMS_22]\n,INP.[CMS_33]\n,INP.[CMS_33CL]\n,INP.[CMS_19]\n,INP.[CMS_19CL]\n,INP.[CMS_39]\n,INP.[CMS_40]\n,INP.[CMS_10]\n,INP.[CMS_11]\n,CAST(REPLACE(REPLACE(TRIM(INP.[CMS_23]),'-Best possible',''),'-Worst possible','') AS INT) AS [CMS_23]\n,NULLIF(LEN(INP.CMS_24),1) AS [CMS_24]\n,CASE WHEN INP.SECTADMI IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTADMI] ELSE NULL END Sentiment_SECTADMI\n,CASE WHEN INP.SECTDISC IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTDISC] ELSE NULL END Sentiment_SECTDISC\n,CASE WHEN INP.SECTHOSP IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTHOSP] ELSE NULL END Sentiment_SECTHOSP\n,CASE WHEN INP.SECTMEAL IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTMEAL] ELSE NULL END Sentiment_SECTMEAL\n,CASE WHEN INP.SECTNURS IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTNURS] ELSE NULL END Sentiment_SECTNURS\n,CASE WHEN INP.SECTOVER IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTOVER] ELSE NULL END Sentiment_SECTOVER\n,CASE WHEN INP.SECTPHYS IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTPHYS] ELSE NULL END Sentiment_SECTPHYS\n,CASE WHEN INP.SECTROOM IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTROOM] ELSE NULL END Sentiment_SECTROOM\n,CASE WHEN INP.SECTTNT  IS NOT NULL THEN SPOS.[vader_SentimentPredictedCompound_SECTTNT]  ELSE NULL END Sentiment_SECTTNT \n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTADMI] = 1 THEN SPOS.[positiveSECTADMI] ELSE SPOS.[negativeSECTADMI] END AS Words_SECTADMI\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTADMI] = 1 THEN SPOS.[positive_subjectSECTADMI] ELSE SPOS.[negative_subjectSECTADMI] END AS Subject_SECTADMI\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTDISC] = 1 THEN SPOS.[positiveSECTDISC] ELSE SPOS.[negativeSECTDISC] END AS Words_SECTDISC\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTDISC] = 1 THEN SPOS.[positive_subjectSECTDISC] ELSE SPOS.[negative_subjectSECTDISC] END AS Subject_SECTDISC\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTHOSP] = 1 THEN SPOS.[positiveSECTHOSP] ELSE SPOS.[negativeSECTHOSP] END AS Words_SECTHOSP\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTHOSP] = 1 THEN SPOS.[positive_subjectSECTHOSP] ELSE SPOS.[negative_subjectSECTHOSP] END AS Subject_SECTHOSP\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTMEAL] = 1 THEN SPOS.[positiveSECTMEAL] ELSE SPOS.[negativeSECTMEAL] END AS Words_SECTMEAL\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTMEAL] = 1 THEN SPOS.[positive_subjectSECTMEAL] ELSE SPOS.[negative_subjectSECTMEAL] END AS Subject_SECTMEAL\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTNURS] = 1 THEN SPOS.[positiveSECTNURS] ELSE SPOS.[negativeSECTNURS] END AS Words_SECTNURS\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTNURS] = 1 THEN SPOS.[positive_subjectSECTNURS] ELSE SPOS.[negative_subjectSECTNURS] END AS Subject_SECTNURS\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTOVER] = 1 THEN SPOS.[positiveSECTOVER] ELSE SPOS.[negativeSECTOVER] END AS Words_SECTOVER\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTOVER] = 1 THEN SPOS.[positive_subjectSECTOVER] ELSE SPOS.[negative_subjectSECTOVER] END AS Subject_SECTOVER\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTPHYS] = 1 THEN SPOS.[positiveSECTPHYS] ELSE SPOS.[negativeSECTPHYS] END AS Words_SECTPHYS\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTPHYS] = 1 THEN SPOS.[positive_subjectSECTPHYS] ELSE SPOS.[negative_subjectSECTPHYS] END AS Subject_SECTPHYS\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTROOM] = 1 THEN SPOS.[positiveSECTROOM] ELSE SPOS.[negativeSECTROOM] END AS Words_SECTROOM\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTROOM] = 1 THEN SPOS.[positive_subjectSECTROOM] ELSE SPOS.[negative_subjectSECTROOM] END AS Subject_SECTROOM\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTTNT] = 1 THEN SPOS.[positiveSECTTNT] ELSE SPOS.[negativeSECTTNT] END AS Words_SECTTNT\n,CASE WHEN SPOS.[vader_SentimentPredictedCompound_SECTTNT] = 1 THEN SPOS.[positive_subjectSECTTNT] ELSE SPOS.[negative_subjectSECTTNT] END AS Subject_SECTTNT\nFROM [dbo].[StagingIN_PATIENT_SURVEY] INP \nINNER JOIN [dbo].[Inpatient_Sentiments_POSTagging] SPOS\n ON INP.SurveyId = SPOS.SurveyId",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "advcompplatsql",
				"poolName": "advcompplatsql"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}